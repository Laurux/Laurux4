' Gambas class file

R As Integer
G As Integer
B As Integer
Coln As Boolean
Inherits PdfWriter

Public Sub _new()
  
  R = Start.R
  G = Start.G
  B = Start.B
  Me.SetFillColor(R, G, B)
  
End

Public Sub _free()
  
End

'---------------------------- Entete des impressions normales ----------------------------------------
Public Sub EnteteN(ent As String)
  
  Me.AddPage
  Me.SetXY(2, 5)
  Me.SetFont("Helvetica", "B", 16)
  Me.SetFillColor(R, G, B)
  Me.cell(206, 8, ent, True, 0, "C", True)
  
End

'Lignes continues
Public Sub Lines(PosY As String)
  
  Me.SetXY(7, PosY)
  Me.SetLineWidth(0.1)
  Me.Line(6, PosY, 205, PosY)
  
End

Public Sub Entete(rs As String, adr11 As String, adr22 As String, ville As String, cap As String, rcs As String, siret As String, ape As String, Tvaintra As String, tel As String, portable As String, fax As String, mail As String, site As String, Pays As String, Iban As String, Col As Boolean)
  
  Dim Posy As Integer
  
  Coln = col
  Me.AddPage
  Me.SetLineWidth(0.1)
  Me.Line(6, 7, 100, 7)
  Me.Line(6, 90, 100, 90)
  Me.Line(6, 7, 6, 90)
  Me.Line(100, 7, 100, 90)
  Posy = 8
  Me.SetXY(7, PosY)
  logo()
  'On imprime l'adresse de la société
  Me.SetFont("Helvetica", "B", 12)
  Me.cell(40, 4, rs, False, 0, "L", False)
  Me.SetXY(6, PosY)
  Me.SetFont("Helvetica", "B", 10)
  posY = posY + 6
  Me.SetXY(8, PosY)
  Me.cell(40, 4, adr11, False, 0, "L", False)
  posY = posY + 5
  Me.SetXY(8, PosY)
  Me.cell(40, 4, adr22, False, 0, "L", False)
  posY = posY + 5
  Me.SetXY(8, PosY)
  Me.cell(40, 4, ville, False, 0, "L", False)
  Me.SetFont("Helvetica", "", 10)
  posY = posY + 6
  Me.SetXY(8, PosY)
  If Not IsNull(cap) Then
    Me.cell(40, 4, cap, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(rcs) Then
    Me.cell(40, 4, rcs, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(siret) Then
    Me.cell(40, 4, siret, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(ape) Then
    Me.cell(40, 4, ape, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(tvaintra) Then
    Me.cell(40, 4, tvaintra, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(tel) Then
    Me.cell(40, 4, tel, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(portable) Then
    Me.cell(40, 4, portable, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(fax) Then
    Me.cell(40, 4, fax, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(site) Then
    Me.cell(40, 4, site, False, 0, "l", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(mail) Then
    Me.cell(40, 4, mail, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  If Not IsNull(iban) Then
    Me.SetFont("Helvetica", "I", 8)
    Me.cell(40, 4, iban, False, 0, "L", False)
    posY = posY + 5
    Me.SetXY(8, PosY)
  Endif
  
End

'---------------------------- Entete du destinataire ----------------------------------------
Public Sub Entete2(rs2 As String, adr1 As String, adr2 As String, ville As String, Pays As String, Col As String, entete As Boolean)
  
  Dim Posy As Integer
  
  Posy = 56
  If entete Then Me.AddPage
  Me.SetXY(114, PosY)
  Me.SetLineWidth(0.1)
  Me.Line(110, 55, 110, 90)
  Me.Line(204, 55, 204, 90)
  Me.Line(110, 55, 204, 55)
  Me.Line(110, 90, 204, 90)
  Me.SetFont("Helvetica", "B", 11)
  Me.cell(40, 4, Left$(rs2, 40), False, 0, "L", False)
  Me.SetFont("Helvetica", "", 11)
  posY = posY + 6
  Me.SetXY(114, PosY)
  Me.cell(40, 4, adr1, False, 0, "L", False)
  posY = posY + 5
  Me.SetXY(114, PosY)
  Me.cell(40, 4, adr2, False, 0, "L", False)
  posY = posY + 5
  Me.SetXY(114, PosY)
  Me.cell(40, 4, ville, False, 0, "L", False)
  posY = posY + 5
  Me.SetXY(114, PosY)
  Me.cell(40, 4, pays, False, 0, "L", False)
  
End

Public Sub Logo()
  
  Dim $logo As String
  Dim iFormat As Integer
  Dim hImage As Image
  Dim L As Integer = 80
  Dim h As Integer = 40
  Dim L2 As Integer
  Dim x As Integer = 116
  Dim Y As Integer = 8
  
  If Settings["/Soc" & Start.Societe & "/glogo"] Then
    Try $Logo = Settings["/Soc" & Start.Societe & "/Logo"]
    Try hImage = Image.Load(Settings["/Soc" & Start.Societe & "/Logo"])
    Try L2 = hImage.Width / 10
    If Not Error Then
      If Not IsNull($Logo) Then
        Me.Image($Logo, X + L / L2, Y + h / hImage.Height, L, h)
      Endif
    Endif
  Endif
  
End

' date d'impression
Public Sub Level1(Jour As String, dte As String, Org As String)
  
  Me.SetXY(9, 100)
  Me.SetFont("Helvetica", "", 12)
  If Org = "1" Then
    Me.cell(40, 5, "Relevé de facture du " & dte, False, 0, "L", False)
  Else
    Me.cell(40, 5, "Relevé de compte du " & dte, False, 0, "L", False)
  Endif
  Me.SetXY(189, 100)
  Me.SetFont("Helvetica", "", 10)
  Me.Cell(20, 6, "Page " & Me.PageNo() & "/{nb}", False, 0, "C", False)
  
End

'Entete des lignes de facture
Public Sub Level2()
  
  Me.SetXY(7, 110)
  Me.SetFont("Helvetica", "", 10)
  Me.cell(26, 5, "Date", True, 0, "C", True)
  Me.cell(26, 5, "N° de facture", True, 0, "C", True)
  Me.cell(96, 5, "Intitulé", True, 0, "C", True)
  Me.cell(24, 5, "Débit", True, 0, "C", True)
  Me.cell(24, 5, "Crédit", True, 0, "C", True)
  
End

'Lignes de facture
Public Sub Level3(dte As String, num As String, lib As String, mtd As String, mtc As String, Posy As Integer)
  
  Me.SetXY(7, Posy)
  Me.SetFont("Helvetica", "", 10)
  Me.cell(26, 4, dte, False, 0, "C", False)
  Me.cell(26, 4, num, False, 0, "L", False)
  Me.cell(96, 4, lib, False, 0, "L", False)
  Me.cell(24, 4, mtd, False, 0, "R", False)
  Me.cell(24, 4, mtc, False, 0, "R", False)
  
End

'Total relevé
Public Sub Level4(totmtd As String, totmtc As String, Posy As Integer)
  
  Me.SetXY(125, Posy)
  Me.SetFont("Helvetica", "B", 10)
  Me.cell(30, 5, "Total relevé ", False, 0, "L", False)
  Me.cell(24, 4, totmtd, False, 0, "R", False)
  Me.cell(24, 4, totmtc, False, 0, "R", False)
  
End

'************************************* gestion des relances ******************************************************
' Date du courrier
Public Sub Level5(jour As String)
  
  Me.SetXY(125, 100)
  Me.SetFont("Helvetica", "", 10)
  Me.cell(30, 5, Jour, False, 0, "L", False)
  
End

'Entete des lignes de relances
Public Sub Level6()
  
  Me.SetXY(7, 140)
  Me.SetFont("Helvetica", "", 10)
  Me.cell(28, 5, "Date echeance", True, 0, "C", True)
  Me.cell(26, 5, "N° de facture", True, 0, "C", True)
  Me.cell(96, 5, "Intitulé", True, 0, "C", True)
  Me.cell(24, 5, "Débit", True, 0, "C", True)
  Me.cell(24, 5, "Crédit", True, 0, "C", True)
  
End

'Lignes de relances
Public Sub Level7(dte As String, num As String, lib As String, mtd As String, mtc As String, Posy As Integer)
  
  Me.SetXY(7, Posy)
  Me.SetFont("Helvetica", "", 10)
  Me.cell(28, 4, dte, False, 0, "C", False)
  Me.cell(26, 4, num, False, 0, "L", False)
  Me.cell(96, 4, lib, False, 0, "L", False)
  Me.cell(24, 4, mtd, False, 0, "R", False)
  Me.cell(24, 4, mtc, False, 0, "R", False)
  
End

' Texte
Public Sub Level8(txt As String, PosY As Integer)
  
  Me.SetFont("Helvetica", "", 10)
  Me.SetXY(7, PosY)
  Me.Multicell(294, 5, Txt, False, "L", False)
  
End

' Texte bas de relevé
Public Sub Level9(txt As String, PosY As Integer)
  
  Me.SetFont("Helvetica", "", 10)
  Me.SetXY(7, PosY)
  Me.Multicell(200, 5, Txt, False, "C", False)
  
End

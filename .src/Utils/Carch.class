' Gambas class file

' Gambas CLASS file
'----------------------------------------------------------------------------
'

'
'Ce programme est un logiciel libre; Vous pouvez le redistribuer et/ou
'le modifier selon les termes de la GNU General PUBLIC License publiés par
'la Free Software Foundation.

'Ce programme est distribué sans garantie. Voyez la GNU General PUBLIC
'License pour plus de details.

'Vous devez lire la GNU General PUBLIC Licence.
'Si vous ne disposez pas d'un exemplaire, veuillez écrire
'à " The Free Software Foundation
'INC, 59 Temple place - Suite 33, Boston
'MA 02111-1307 USA
'----------------------------------------------------------------------------
'################################################
'# nom du fichier           : Carch.class
'# Auteur                   : Jacky Tripoteau
'# date de création         : 30/11/2007
'# Gestion des couleurs des archives
'################################################

sColor As String
Value As String
Factures As String
Avoirs As String
B As Integer

'*********************************
'*    initialisation écran       *
'*********************************
Public Sub _New()
  
  Me.Center
  Factures = Settings["/Coul/Facts"]
  If IsNull(Factures) Then Factures = "&HF9F9BD&"
  Facts2.Text = Factures
  Facts.Background = Val(Factures)
  
  Avoirs = Settings["/Coul/Avs"]
  If IsNull(Avoirs) Then Avoirs = "&HF9F9BD&"
  Avs2.Text = Avoirs
  Avs.Background = Val(Avoirs)
  
End

Public Sub Coul_Dblclick()
  
  Pcol.Show
  Select Case Last.tag
    Case 1
      dlgColor.SelectedColor = Val(Factures)
      b = 1
      Stop Event
    Case 2
      dlgColor.SelectedColor = Val(Avoirs)
      b = 2
      Stop Event
  End Select
  
End

Public Sub btnOK_Click()
  
  sColor = dlgColor.SelectedColor
  Value = "&H" & Hex$(dlgColor.SelectedColor, 6) & "&"
  Pcol.Hide
  Select Case B
    Case 1
      Facts2.Text = Value
      Facts.Background = dlgColor.SelectedColor
    Case 2
      Avs2.Text = Value
      avs.Background = dlgColor.SelectedColor
  End Select
  
End

Public Sub btnRetour_Click()
  
  Pcol.Hide
  
End

Public Sub Btn_Click()
  
  Select Case Last.tag
    Case 1
      Settings["/Coul/Facts"] = Facts2.Text
      Settings["/Coul/Avs"] = Avs2.Text
      
      Me.close
    Case 2
      Me.Close
  End Select
  
End

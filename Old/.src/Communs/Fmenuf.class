' Gambas class file

'----------------------------------------------------------------------------
'

'
'Ce programme est un logiciel libre; Vous pouvez le redistribuer et/ou
'le modifier selon les termes de la GNU General PUBLIC License publiés par
'la Free Software Foundation.
'Ce programme est distribué sans garantie. Voyez la GNU General PUBLIC
'License pour plus de details

'Vous devez lire la GNU General PUBLIC Licence.
'Si vous ne disposez pas d'un exemplaire, veuillez écrire
'à  " The Free Software Foundation
'INC, 59 Temple place - Suite 33, Boston
'MA 02111-1307 USA
'----------------------------------------------------------------------------
'################################################
'# nom du fichier           : FMenu.class
'# Auteur                   : Jacky Tripoteau
'# date de création         : 01/11/2004
'# Menu général de Laurux avec compta et facturation
'################################################
'
Public Soc As String
Public intitule As String
Public Version As String
Public Hfile As File
Public d As String
Public son As Integer = Start.Son
Public Lig As String
Public cle As String
Public iPos As Integer
Private hForm As Materiel

Public Sub _new()
  
  Dim WidthME As String 
  Dim spl As New String[2]
  
  If Settings["/Soc" & Start.Societe & "/Tme"] Then
    WidthME = Trim(Settings["/Soc" & Start.Societe & "/Ecran"])
    spl = Scan(WidthME, "*;*")
    Try Me.Width = Trim(spl[0])
    Try Me.height = Trim(spl[1])
  Endif
  Me.Center
  
End

Public Sub Form_Open()
  
  Dim titre As String
  Dim Btq As String
  Dim Mat As String
  Dim $con_ok As Boolean = True ' flag d'autorisation de connexion
  Dim promo As Boolean
  Dim cpromo, lpromo As String
  Dim rResult As Result
  Dim Tab As String = "Fiches_Societes"
  Dim Cai As String
  Dim Chemin As String = Application.Path & "/Fonds_Laurux/"
  
  titre = fmenu.text
  Try Version = Settings["/dbase/Version"]
  Try Soc = Settings["/Soc"]
  Try intitule = Settings["/intitule"]
  If Settings["/Soc" & Start.Societe & "/Btq"] = True Then Btq = "1"
  Menu2showhide(Btq)
  Try Music.Load("son/menu.ogg")
  If Settings["/Soc" & Start.Societe & "/Materiel"] = True Then Mat = "1"
  Menu3showhide(Mat)
  If Settings["/Soc" & Start.Societe & "/Blocsoc"] = True Then
    Menu26.Visible = False
    'Menu65.visible = False
    'Menu49.visible = False
  Endif
  If Settings["/Soc" & Start.Societe & "/Vendeurs"] = False Then 
    Menu232.Visible = False
  Else
    Menu232.Visible = True
  Endif
  If Settings["/Soc" & Start.Societe & "/Admin"] = True Then Menu120.Visible = False
  If Settings["/Soc" & Start.Societe & "/Caisse"] = True Then Cai = "1"
  Menu4showhide(Cai)
  If Settings["/Soc" & Start.Societe & "/Faca"] = 0 Then Menu239.visible = False
  If Settings["/Soc" & Start.Societe & "/Sms"] = 0 Then 
    Menu251.visible = False
    Menu253.visible = False
  Endif
  If Error Then
    Message.Warning("Attention, le fichier de configuration n'existe pas ! \n Veuillez completer les zones nécéssaires à  sa création SVP !")
    preferences()
    Config()
  Endif
  '# -- initialisation des informations SQL
  '* MG - 07 janvier 2010
  Utils.glb()
  
  '# -- montage éventuel du tunnel ssh
  '* MG - 07 janvier 2010
  If Settings["/dbase/Con-ssh"] Then
    If Not Utils.monteTunnel() Then
      $con_ok = False
    Endif
  Endif
  
  If $con_ok Then
    Utils.db.Open
    Utils.db.exec("SET NAMES 'latin1'")
    rResult = Utils.db.Exec("SELECT * FROM " & Tab & " where cd_sc = &1", Soc)
    If rResult.Available Then Soc = rResult!type_sc & " - " & rResult!int_sc
    Fmenuf.text = "Société en cours : " & Soc
    If Settings["/Soc" & Start.Societe & "/Infob"] Then Application.ShowTooltips = False
    If Settings["/Soc" & Start.Societe & "/Cnomade"] Then 
      Menu241.Visible = True
    Else
      Menu241.Visible = False
    Endif
    If Not IsNull(Settings["/Soc" & Start.Societe & "/Fecran"]) Then
      If Exist(chemin & Settings["/Soc" & Start.Societe & "/Fecran"]) Then
        PictureBox1.Picture = picture[Chemin & Settings["/Soc" & Start.Societe & "/Fecran"]]
      Endif
    Endif
    If Settings["/Soc" & Start.Societe & "/Slide"] Then
      Select Case Settings["/Soc" & Start.Societe & "/Fecran"]
        Case "Laurux1.jpg" 
          Settings["/Soc" & Start.Societe & "/Fecran"] = "Laurux2.jpg"
        Case "Laurux2.jpg" 
          Settings["/Soc" & Start.Societe & "/Fecran"] = "Laurux3.jpg"
        Case "Laurux3.jpg" 
          Settings["/Soc" & Start.Societe & "/Fecran"] = "Laurux4.jpg"
        Case "Laurux4.jpg" 
          Settings["/Soc" & Start.Societe & "/Fecran"] = "Laurux5.jpg"
        Case "Laurux5.jpg" 
          Settings["/Soc" & Start.Societe & "/Fecran"] = ""
        Case Null
          Settings["/Soc" & Start.Societe & "/Fecran"] = "Laurux1.jpg"
        Case Else
          Settings["/Soc" & Start.Societe & "/Fecran"] = ""
      End Select 
    Endif
    LauruxMaj.Verif_Version()
    SetObserver(ScrollView1)
    Try rResult = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabPromo") & " where datedeb = &1", Format$(Now, "yyyy-mm-dd"))
    If Not Error Then
      If rResult.Available Then
        Promo = True
        Cpromo = rResult!code
        Lpromo = rResult!libelle
      Endif
      If Promo = True Then
        Syntheses.Message("La promotion " & Cpromo & ", " & Lpromo & ", débute aujourd'hui . Pensez aux impressions d' étiquettes de début de promotion")
        Message.Info("Rappel: La promotion " & Cpromo & " " & Lpromo & " débute aujourd'hui !\n Pensez aux impressions d' étiquettes de début de promotion")
      Endif
      Promo = False
      rResult = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabPromo") & " where datefin = &1", Format$(Now, "yyyy-mm-dd"))
      If rResult.Available Then
        Promo = True
        Cpromo = rResult!code
        Lpromo = rResult!libelle
      Endif
      If Promo = True Then
        Syntheses.Message("La promotion " & Cpromo & ", " & Lpromo & ", se termine aujourd'hui ! Pensez aux impressions d'étiquettes de fin de promotion.")
        Message.Info("Rappel: La promotion " & Cpromo & " " & Lpromo & " se termine aujourd'hui !\nPensez aux impressions d'étiquettes de fin de promotion.")
      Endif
      promo = False
      If Settings["/Soc" & Start.Societe & "/Faca"] Then Abonnement()
      If son Then
        Music.Load("son/menu.ogg")
        Music.Play
      Endif
    Endif
  Else
    Message.Warning("Le tunnel SSH n'a pu être établi, la connexion SQL est impossible")
    Config()
  Endif
Catch
  If Left$(error.Text, 19) = "Driver name missing" Then
    Message.Warning("Attention, le fichier de configuration n'existe pas ! \n Veuillez completer les zones nécéssaires à sa création SVP !")
  Else
    If Left$(error.Text, 13) = "type mismatch" Then
      Message.Warning("Attention, le fichier de configuration n'existe pas ou est corrompu !")
    Else
      If Left$(error.Text, 27) = "Cannot open database: Acces" Then
        Message.Warning("Attention, l' utilisateur ou le mot de passe est erroné ! \n Veuillez controler votre saisie SVP !")
      Else
        If Left$(error.Text, 38) = "Cannot open database: Unknown database" Then
          Message.Warning("Attention, la base Laurux01 n'existe pas !\n Veuillez remplir le fichier de configuration SVP !")
        Endif
      Endif
    Endif
  Endif
  preferences()
  Config()
  
End

Public Sub Timer1_Timer()
  
  AffRdv.Calc_Timer(Timer1)
  
End

Public Sub Abonnement()
  
  Dim DteN, DteN2, dateAb, dateAb2, Aban, DteFac, Code As String
  Dim rClient As Result
  Dim impok As Boolean = False
  Dim nb As Integer = 0
  
  dteN = Format$(Now, "yyyymmdd")
  DteN2 = Format$(Now, "dd.mm.yyyy")
  rClient = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabBl") & " Left join " & Cbase.Table("TabCli") & " on cli_code = cdclibl where type = &1 and totalht <> &2 and dtefac <= &3 order by cdclibl asc, dtefac desc", "A", 0, Utils.cdate_dbase(dteN2))
  If rClient.Available Then
    'code = rClient!cdclibl
    Repeat
      dateAb = rClient!cli_datab
      Aban = rClient!cli_aban
      DteFac = rClient!dtefac
      If code <> rClient!cdclibl Then
        If Not IsNull(DteFac) Then
          Select Case Aban
            Case "1- Mensuel"
              dateAb2 = (Val(Format$(Now, "mm")) - 1)
              If Val(DateAb2) <= 0 Then DateAb2 = Str(12 - Val(DateAb2))
              If Val(Left$(DteFac, 2)) = DateAb2 Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Left$(dteN, 2))) Then 
                  impok = True
                  Inc nb
                Endif
              Endif
            Case "2- Bimensuel"
              dateAb2 = (Val(Mid$(dteN, 4, 2)) - 2)
              If Val(DateAb2) <= 0 Then DateAb2 = Str(12 - Val(DateAb2))
              If Val(Left$(DteFac, 2)) = DateAb2 Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Left$(dteN, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
            Case "3- Trimestriel"
              dateAb2 = (Val(Mid$(dteN, 4, 2)) - 3)
              If Val(DateAb2) <= 0 Then DateAb2 = Str(12 - Val(DateAb2))
              If Val(Left$(DteFac, 2)) = DateAb2 Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Left$(dteN, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
            Case "4- Semestriel"
              dateAb2 = (Val(Mid$(dteN, 4, 2)) - 6)
              If Val(DateAb2) <= 0 Then DateAb2 = Str(12 - Val(DateAb2))
              If Val(Left$(DteFac, 2)) = DateAb2 Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Left$(dteN, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
            Case "5- Annuel"
              dateAb2 = (Val(Format$(Now, "yyyy")) - 1)
              If Val(Right$(DteFac, 4)) <= Val(dateAb2) Then
                If Val(Mid$(DteFac, 4, 2)) <= (Val(Right$(dteN, 2))) Then
                  impok = True
                  Inc nb
                Endif
              Endif
          End Select
        Else
          impok = True
          Inc nb
        Endif
      Endif
      code = rClient!cdclibl
    Until rClient.MoveNext()
    If impok = True Then
      Syntheses.Message("Aujourd'hui, il y a " & nb & " factures périodiques a imprimer.")
      Message.Info("Aujourd'hui, il y a " & nb & " facture(s) périodique(s) a imprimer!")
    Endif
  Endif
  
End

Public Sub Menu2showhide(Btq As String) As String
  
  If Btq = "1" Then
    Menu133.Visible = True
    Menu132.Visible = True
  Else
    Menu133.Visible = False
    Menu132.Visible = False
  Endif
  
End

Public Sub Menu3showhide(Mat As String) As String
  
  If Mat = "1" Then
    Menu129.Visible = True
    Menu141.Visible = True
    HBox17.Visible = True
    HBox18.Visible = True
  Else
    Menu129.Visible = False
    Menu141.Visible = False
    HBox17.Visible = False
    HBox18.Visible = False
  Endif
  
End

Public Sub Menu4showhide(Cai As String) As String
  
  If Cai = "1" Then
    Menu203.Visible = True
    Menu237.Visible = True
  Else
    Menu203.Visible = False
    Menu237.Visible = False
  Endif
  
End

Public Sub preferences()
  
  Settings["/son"] = 0
  Settings["/Tips"] = 1
  Settings["/Soc" & Soc & "/Entete"] = 1
  Settings["/Soc" & Soc & "/Conditions"] = 1
  Settings["/Soc" & Soc & "/Tva550"] = 0
  Settings["/Soc" & Soc & "/Codetva"] = " "
  Settings["/Soc" & Soc & "/Compta"] = 0
  Settings["/Soc" & Soc & "/Gestion"] = 0
  Settings["/Soc" & Soc & "/CptFac"] = 1
  Settings["/Soc" & Soc & "/Qt1"] = 0
  Settings["/Soc" & Soc & "/Coul_fen"] = 0
  Settings["/Soc" & Soc & "/Qt1"] = 0
  Settings["/Soc" & Soc & "/Ctrlstk"] = 0
  Settings["/Soc" & Soc & "/AutoEnt"] = 0
  Settings["/Coul" & "/Fnets"] = "Background: &HDDDDDD&; "
  Settings["/Coul" & "/Btns"] = "Background: &HBDBDBD&; "
  Settings["/Coul" & "/Znss"] = "Background: &HFAFAFA&; "
  Settings["/Coul" & "/Znaff"] = "Background: &HEEEEEE&; "
  Settings["/Coul" & "/Focus"] = "Background: &HF9FFC7&; "
  Settings["/Coul" & "/Coulfonds"] = "Background: &FFEE81&; "
  Settings["/Coul" & "/Others"] = "Background: &FFE0B8&; "
  Settings["/Coul" & "/Fcs"] = "Background: &HF9FFC7&"
  Settings["/Coul" & "/Stk"] = "Background: &HCFF58E&; Font: serif,9; "
  Settings["/Coul" & "/Coulfonds"] = "255,252,216,"
  Settings["/Coul" & "/Others"] = "255,232,199,"
  Settings["/Coul" & "/Facts"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Coul" & "/Avs"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Coul" & "/Bl"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Coul" & "/Devis"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Coul" & "/Cmde"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Coul" & "/Prf"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Coul" & "/Nstk"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Coul" & "/Eps"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Coul" & "/Spd"] = "Background: &HFFFFFF&; Font: Serif,9; "
  Settings["/Soc" & Soc & "/Font"] = "Serif,+1"
  Settings["/Soc" & Soc & "/Copie"] = 0
  Settings["/Soc" & Soc & "/Siret"] = "Siret"
  Settings["/Soc" & Soc & "/Prxdec"] = 0
  Settings["/Soc" & Soc & "/Taxe"] = "TVA"
  Settings["/Soc" & Start.Societe & "/Vendeurs"] = "0"
  Settings["/Soc" & Start.Societe & "/Slide"] = 1
  Settings.Save
  Settings.Reload
  
End

Public Sub Config()
  
  LauruxConf.ShowModal()
  
End

Public Sub Menu114_Click()
  
  Fcomptes.Show
  
End

Public Sub Menu112_Click()
  
  FTvav.Show
  
End

Public Sub Menu113_Click()
  
  FTvac.show
  
End

Public Sub Menu111_Click()
  
  EdImpayes.show
  
End

Public Sub Menu12_Click()
  
  FClient.ShowModal()
  
End

Public Sub Menu13_Click()
  
  Ffournisseur.ShowModal()
  
End

Public Sub Client_Click()
  
  menu12_Click()
  
End

Public Sub fournisseur_Click()
  
  Menu13_Click()
  
End

Public Sub compte_Click()
  
  Menu114_Click()
  
End

Public Sub Tva_Click()
  
  Menu113_Click()
  
End

Public Sub Tvac_Click()
  
  Menu113_Click()
  
End

Public Sub libellesaisies_Click()
  
  Menu24_Click()
  
End

Public Sub collectif_Click()
  
  Fcollectif.show
  
End

Public Sub Menu15_Click()
  
  Articles.ShowModal()
  
End

Public Sub Menu20_Click()
  
  Fabout.Show
  
End

Public Sub Menu26_Click()
  
  If Settings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Fsoc.Show
      Start.Motdepasse = ""
    Endif
  Else
    Fsoc.Show
  Endif
  
End

Public Sub Menu21_Click()
  
  SetColors.ShowDialog
  
End

Public Sub Menu22_Click()
  
  Impclient.Show
  
End

Public Sub Menu24_Click()
  
  StatCA.ShowModal
  
End

Public Sub Menu25_Click()
  
  If Settings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Parametre.Show
      Start.Motdepasse = ""
    Endif
  Else
    Parametre.Show
  Endif
  
End

Public Sub Menu38_Click()
  
  Dim Myform As Etiqart
  
  MyForm = New Etiqart("")
  MyForm.Showmodal()
  
End

Public Sub Menu61_Click()
  
  Pointage.Show
  
End

Public Sub Menu16_Click()
  
  Extrait.Show
  
End

'*********************************
'*   Recherche du navigateur     *
'* Procedure de Benoit Minisini  *
'*********************************
Public Sub Menu23_Click()
  
  Exec ["xdg-open", Application.Path &/ "Ecrans/LauruxIndexParCategories.html"]
  
End

Public Sub Menu32_Click()
  
  journaux.ShowModal()
  
End

Public Sub Menu121_Click()
  
  Me.Close
  
End

Public Sub form_close()
  
  Try Kill User.home & "/Laurux.lock"
  Settings["/Soc" & Start.Societe & "/Ecran"] = Me.Width & ";" & Me.Height
  If Settings["/Soc" & Start.Societe & "/Sauvauto"] And If Settings["/dbase/Maj"] Then SauvesAuto.Sauvegarde(Me)
  If son Then
    Music.Load("son/fermeture-menu.ogg")
    Music.Play
    Wait 1.5
  Endif
  Utils.fermeTunnel()
  Utils.db.Close
  
End

Public Sub ToolButton1_Click()
  
  Menu121_Click()
  
End

Public Sub Menu46_Click()
  
  Eticli.Show
  
End

Public Sub Menu27_Click()
  
  Carch.Show
  
End

Public Sub Menu49_Click()
  
  If Settings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      LauruxConf.ShowModal
      Start.Motdepasse = ""
    Endif
  Else
    LauruxConf.ShowModal
  Endif
  
End

Public Sub Menu50_Click()
  
  FEditRel.Show
  
End

Public Sub Menu30_Click()
  
  ClotureF.Show
  
End

Public Sub Menu52_Click()
  
  Expclient.Show
  
End

Public Sub Menu40_Click()
  
  Dim Myform As Etigond
  
  MyForm = New Etigond("")
  MyForm.Showmodal()
  
End

Public Sub Menu54_Click()
  
  EdFam.Show
  
End

Public Sub Menu57_Click()
  
  FSauve.ShowModal()
  
End

Public Sub Menu59_Click()
  
  Edmo.Show
  
End

Public Sub Menu65_Click()
  
  If Settings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      FRestore.ShowModal()
      Start.Motdepasse = ""
    Endif
  Else
    FRestore.ShowModal()
  Endif
  
End

Public Sub Menu60_Click()
  
  Emailing.Show
  
End

Public Sub Menu73_Click()
  
  EdArt1.Show
  
End

Public Sub Menu74_Click()
  
  EdArt2.Show
  
End

Public Sub Achat_Click()
  
  Menu21_Click
  
End

Public Sub Tresor_Click()
  
  Menu22_Click
  
End

Public Sub Menu14_Click()
  
  Famille.Show
  
End

Public Sub Menu70_Click()
  
  Frelance.Show
  
End

Public Sub Menu17_Click()
  
  Comment.Show
  
End

Public Sub Menu28_Click()
  
  Txmo.Show
  
End

Public Sub Article_Click()
  
  Menu15_Click()
  
End

Public Sub Menu1_Click()
  
  Fcomptes.Show
  
End

Public Sub Menu37_Click()
  
  Movr.ShowModal()
  
End

Public Sub mo_Click()
  
  Menu37_Click()
  
End

Public Sub Menu42_Click()
  
  If Settings["/Soc" & Start.Societe & "/Vendeurs"] <> 0 And Not IsNull(Settings["/Soc" & Start.Societe & "/CodeVendeur"]) Then
    Facture.ShowModal()
  Else
    If Settings["/Soc" & Start.Societe & "/Vendeurs"] = 0 Or If IsNull(Settings["/Soc" & Start.Societe & "/Vendeurs"]) Then
      Facture.ShowModal()
    Else
      ConVendeurs.ShowModal()
    Endif
  Endif
  
End

Public Sub ToolButton2_Click()
  
  Menu42_Click()
  
End

Public Sub Menu72_Click()
  
  Archives.ShowModal()
  
End

Public Sub Tvav_Click()
  
  Menu112_Click()
  
End

Public Sub Menu76_Click()
  
  FEditRel.Show
  
End

Public Sub ToolButton3_Click()
  
  Menu61_Click()
  
End

Public Sub ToolButton4_Click()
  
  Menu16_Click()
  
End

Public Sub ToolButton5_Click()
  
  Menu40_Click()
  
End

Public Sub Menu78_Click()
  
  Receipt.showModal()
  
End

Public Sub Blm_Click()
  
  Menu78_Click()
  
End

Public Sub Menu79_Click()
  
  Mvtex.showModal()
  
End

Public Sub Mvt_Click()
  
  Menu79_Click()
  
End

Public Sub Menu88_Click()
  
  Commande.showModal()
  
End

Public Sub com_Click()
  
  Menu88_Click()
  
End

Public Sub Menu89_Click()
  
  Receipta.showModal()
  
End

Public Sub Bla_Click()
  
  Menu89_Click()
  
End

Public Sub Menu90_Click()
  
  Edbl.Show
  
End

Public Sub Menu91_Click()
  
  Edregul.Show
  
End

Public Sub Menu92_Click()
  
  Edcom.Show
  
End

Public Sub Menu122_Click()
  
  EdStk.Show
  
End

Public Sub Menu81_Click()
  
  Geninv.Show
  
End

Public Sub Menu82_Click()
  
  Saisieinv.Show
  
End

Public Sub Menu84_Click()
  
  Validinv.Show
  
End

Public Sub Menu83_Click()
  
  Ecarts.Show
  
End

Public Sub Menu85_Click()
  
  Edinv.Show
  
End

Public Sub Menu93_Click()
  
  Ednsaisis.Show
  
End

Public Sub Menu95_Click()
  
  GeninvT.Showmodal()
  
End

Public Sub Menu96_Click()
  
  SaisieinvT.Show
  
End

Public Sub Menu97_Click()
  
  EcartsT.Show
  
End

Public Sub Menu98_Click()
  
  EdnsaisisT.Show
  
End

Public Sub Menu99_Click()
  
  EdinvT.Show
  
End

Public Sub Menu100_Click()
  
  ValidinvT.Show
  
End

Public Sub Menu102_Click()
  
  Hit.Show
  
End

Public Sub Menu103_Click()
  
  EdClient.Show
  
End

Public Sub Menu104_Click()
  
  EDfour.Show
  
End

Public Sub Menu105_Click()
  
  StatFam.Show
  
End

Public Sub Menu106_Click()
  
  FRelFacture.Show
  
End

Public Sub Menu107_Click()
  
  Visimpayes.Show
  
End

Public Sub Menu108_Click()
  
  If Settings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Prefs.Show()
      Start.Motdepasse = ""
    Endif
  Else
    Prefs.Show()
  Endif
  
End

Public Sub Menu109_Click()
  
  StatCli.Show
  
End

Public Sub Menu110_Click()
  
  StatClimo.Show
  
End

Public Sub Menu117_Click()
  
  Calcsolde.show
  
End

Public Sub Menu118_Click()
  
  Prgm.Show
  
End

Public Sub Menu119_Click()
  
  If Settings["/Soc" & Start.Societe & "/Admin"] Then
    MDP.showmodal()
    If Start.Motdepasse = "OK" Then
      Majversion.Verif_Maj()
      Start.Motdepasse = ""
    Endif
  Else
    Majversion.Verif_Maj()
  Endif
  
End

Public Sub Menu123_Click()
  
  Ftips.Run
  
End

Public Sub Menu124_Click()
  
  StatTypCli.Show
  
End

Public Sub Menu125_Click()
  
  Lettragesoldes.Show
  
End

Public Sub Menu29_Click()
  
  Cmo.Show
  
End

Public Sub ToolButton6_Click()
  
  Extrait.Show
  
End

Public Sub Menu128_Click()
  
  LibelFac.Show
  
End

Public Sub Menu129_Click()
  
  hForm = New Materiel("")
  hForm.Showmodal()
  
End

Public Sub Menu130_Click()
  
  Cpostaux.Show()
  
End

Public Sub Menu131_Click()
  
  Marques.Show()
  
End

Public Sub Menu132_Click()
  
  ImpJdv.ShowModal
  
End

Public Sub Menu136_Click()
  
  Calcstock.Showmodal
  
End

Public Sub Menu135_Click()
  
  Changefam.ShowModal
  
End

Public Sub Menu142_Click()
  
  Histovart.Show
  
End

Public Sub Menu143_Click()
  
  Histovmo.Show
  
End

Public Sub Menu2_Click()
  
  Fcollectif.Show
  
End

Public Sub Menu5_Click()
  
  Facturefm.Show
  
End

Public Sub Menu7_Click()
  
  ExportJdv.ShowModal
  
End

Public Sub Menu4_Click()
  
  Fjournaux.show
  
End

Public Sub Menu33_Click()
  
  Epurjdv.ShowModal()
  
End

Public Sub Menu31_Click()
  
  EpurMvtexp.ShowModal()
  
End

Public Sub SetObserver(hCont As Container)
  
  Dim hObs As Observer
  Dim o As Control
  
  For Each o In hCont.Children
    If o Is Label Then
      hobs = New Observer(o) As "OBS"
      o.Mouse = mouse.Pointing
    Endif
    If o Is Container Then SetObserver(o)
  Next
  
End

Public Sub OBS_Enter()
  
  Last.Foreground = Color.Blue
  Last.Font.Underline = True
  
End

Public Sub OBS_Leave()
  
  Last.Foreground = Color.ButtonForeground
  Last.Font.Underline = False
  
End

Public Sub lblCli_MouseUp()
  
  menu12_Click()
  
End

Public Sub lblFour_MouseUp()
  
  Menu13_Click()
  
End

Public Sub LblFam_MouseUp()
  
  Menu14_Click()
  
End

Public Sub lblArt_MouseUp()
  
  Menu15_Click()
  
End

Public Sub lblMO_MouseUp()
  
  Menu37_Click()
  
End

Public Sub lblFac_MouseUp()
  
  Menu42_Click()
  
End

Public Sub lblCom_MouseUp()
  
  Menu88_Click()
  
End

Public Sub lblRcptM_MouseUp()
  
  Menu78_Click()
  
End

Public Sub lblRcptA_MouseUp()
  
  Menu89_Click()
  
End

Public Sub lblVrecpt_MouseUp()
  
  Menu236_Click()
  Stop Event
  
End

Public Sub lblRgl_MouseUp()
  
  Menu79_Click()
  
End

Public Sub Menu153_Click()
  
  SetColors.ShowDialog
  
End

Public Sub Menu34_Click()
  
  Typec.show
  
End

Public Sub Menu36_Click()
  
  Remisec.show
  
End

Public Sub lblRem_MouseUp()
  
  Remisec.show
  
End

Public Sub lblClm2_MouseDown()
  
  ConsultArt.Show
  
End

Public Sub lblArch_MouseDown()
  
  Archives.ShowModal()
  
End

Public Sub lblFacfm_MouseDown()
  
  Facturefm.ShowModal
  
End

Public Sub lblClm_MouseDown()
  
  ClotureF.ShowModal
  
End

Public Sub Menu43_Click()
  
  Dim Myform As Etiqart
  
  MyForm = New Etiqart("")
  MyForm.Showmodal()
  
End

Public Sub Menu45_Click()
  
  Dim Myform As Etigond
  
  MyForm = New Etigond("")
  MyForm.Showmodal()
  
End

Public Sub Menu48_Click()
  
  Etiquettes.Show
  
End

Public Sub Menu51_Click()
  
  StatFour.show
  
End

Public Sub Menu66_Click()
  
  TresorFac.ShowModal()
  
End

Public Sub Menu75_Click()
  
  FPrepRel.Show
  
End

Public Sub Menu116_Click()
  
  Visreglements.Show
  
End

Public Sub Menu63_Click()
  
  Exec ["xdg-open", "http://www.laurux.fr"]
  
End

Public Sub Menu120_Click()
  
  Dup.ShowModal
  
End

Public Sub Menu126_Click()
  
  Impart.ShowModal()
  
End

Public Sub Menu133_Click()
  
  Btqart.ShowModal()
  
End

Public Sub lblMat_MouseDown()
  
  hForm = New Materiel("")
  hForm.Showmodal()
  
End

Public Sub Menu141_Click()
  
  FactureMat.ShowModal()
  
End

Public Sub lblFac2_MouseDown()
  
  FactureMat.ShowModal()
  
End

Public Sub Menu144_Click()
  
  echeances.ShowModal
  
End

Public Sub Menu145_Click()
  
  Edpaiement.ShowModal()
  
End

Public Sub Menu146_Click()
  
  Identite.ShowModal()
  
End

Public Sub Menu147_Click()
  
  RelvMo.Show()
  
End

Public Sub Menu148_Click()
  
  RelMoprod.Show()
  
End

Public Sub Menu149_Click()
  
  Tleg.show
  
End

Public Sub Menu151_Click()
  
  Agenda.show
  
End

Public Sub Menu155_Click()
  
  Fcaisses.ShowModal()
  
End

Public Sub Menu157_Click()
  
  LibelTicket.ShowModal()
  
End

Public Sub Menu156_Click()
  
  Fvendeurs.ShowModal()
  
End

Public Sub Menu158_Click()
  
  LibelAvoirs.ShowModal()
  
End

Public Sub Menu159_Click()
  
  Fclientc.ShowModal()
  
End

Public Sub Menu161_Click()
  
  Bordereaux.ShowModal()
  
End

Public Sub Menu162_Click()
  
  Moulinage.ShowModal()
  
End

Public Sub Menu165_Click()
  
  ArchivesTck.ShowModal()
  
End

Public Sub Menu164_Click()
  
  Statcai.Showmodal()
  
End

Public Sub Menu168_Click()
  
  Statut.Show()
  
End

Public Sub Menu170_Click()
  
  Fpromo.ShowModal()
  
End

Public Sub Menu171_Click()
  
  FpromoArt.Showmodal()
  
End

Public Sub Menu172_Click()
  
  StatPromo.ShowModal()
  
End

Public Sub Menu174_Click()
  
  EtiqPromo.ShowModal()
  
End

Public Sub Menu175_Click()
  
  Remisecli.ShowModal()
  
End

Public Sub Menu177_Click()
  
  Prodcomposes.ShowModal()
  
End

Public Sub Menu178_Click()
  
  RazInv.ShowModal()
  
End

Public Sub Menu180_Click()
  
  MvtProdcomp.ShowModal()
  
End

Public Sub Menu179_Click()
  
  RazInvT.ShowModal()
  
End

Public Sub Menu187_Click()
  
  SupprArt.ShowModal()
  
End

Public Sub Menu189_Click()
  
  EtiqRecpt.show
  
End

Public Sub lblClm3_MouseDown()
  
  Fprepdus.show()
  
End

Public Sub Menu191_Click()
  
  FClientcarte.ShowModal()
  
End

Public Sub Menu192_Click()
  
  HitCarte.ShowModal()
  
End

Public Sub Menu194_Click()
  
  EmailingCarte.ShowModal()
  
End

Public Sub Menu185_Click()
  
  Centrales.Show()
  
End

Public Sub Menu196_Click()
  
  ImpartParam.ShowModal()
  
End

Public Sub Menu197_Click()
  
  MajFbtarif2.Showmodal()
  
End

Public Sub Menu198_Click()
  
  Etiqfbtarif.ShowModal()
  
End

Public Sub Menu199_Click()
  
  MajTarifP.show()
  
End

Public Sub Menu200_Click()
  
  MajTarifM.show()
  
End

Public Sub Menu202_Click()
  
  Expbase.show()
  
End

Public Sub Menu203_Click()
  
  Statbase.ShowModal()
  
End

Public Sub Menu186_Click()
  
  Etiqfbtarif.Show()
  
End

Public Sub Menu204_Click()
  
  TBord.Show()
  
End

Public Sub Menu205_Click()
  
  EdRup.Show()
  
End

Public Sub Menu206_Click()
  
  EdDocs.Show()
  
End

Public Sub Menu207_Click()
  
  Tmail.Show()
  
End

Public Sub Menu210_Click()
  
  RazHistoFac.ShowModal()
  
End

Public Sub Menu211_Click()
  
  RazHistoTk.ShowModal()
  
End

Public Sub Menu212_Click()
  
  RazHistoFbl.ShowModal()
  
End

Public Sub Menu213_Click()
  
  Traites.Show()
  
End

Public Sub Menu214_Click()
  
  Edregulprdc.Show()
  
End

Public Sub Menu215_Click()
  
  Fsystem.Show()
  
End

Public Sub Menu217_Click()
  
  Depots.Show()
  
End

Public Sub Menu218_Click()
  
  MvtDepots.Show()
  
End

Public Sub Menu219_Click()
  
  Sdepots.show()
  
End

Public Sub Menu221_Click()
  
  ImpDepots.show()
  
End

Public Sub Menu222_Click()
  
  Edsdepots.Show()
  
End

Public Sub Menu224_Click()
  
  Majcasier.Show()
  
End

Public Sub Menu225_Click()
  
  Variables.OrgTarCli = ""
  TarCli.Show()
  
End

Public Sub Menu226_Click()
  
  Variables.OrgTarTypeCli = ""
  TarTypeCli.Show()
  
End

Public Sub Menu227_Click()
  
  RazArt.Show()
  
End

Public Sub Menu229_Click()
  
  Expart.Show()
  
End

Public Sub Menu230_Click()
  
  Expcontact.Show()
  
End

Public Sub Menu231_Click()
  
  Impcpostaux.Show()
  
End

Public Sub Menu232_Click()
  
  Fvendeurs.Show()
  
End

Public Sub Menu233_Click()
  
  CoefTypeC.Show()
  
End

Public Sub Menu234_Click()
  
  EdMat.show()
  
End

Public Sub Menu235_Click()
  
  RazDevis.showModal()
  
End

Public Sub Menu236_Click()
  
  ValidBR.ShowModal()
  
End

Public Sub Menu237_Click()
  
  RazClientd.ShowModal()
  
End

Public Sub Menu238_Click()
  
  EdArt3.ShowModal()
  
End

Public Sub Menu239_Click()
  
  FacturefmA.ShowModal()
  
End

Public Sub Menu241_Click()
  
  Fimport.ShowModal()
  
End

Public Sub Menu242_Click()
  
  ModifBR.ShowModal()
  
End

Public Sub Menu243_Click()
  
  Changefour.ShowModal()
  
End

Public Sub Menu244_Click()
  
  Facturergbl.ShowModal()
  
End

Public Sub Menu245_Click()
  
  Dim hForm2 As Gged
  
  hForm2 = New Gged("", "", "", "")
  hForm2.Showmodal()
  
End

Public Sub Menu246_Click()
  
  Dim Myform2 As Etiqcasier
  
  MyForm2 = New Etiqcasier("")
  MyForm2.Showmodal()
  
End

Public Sub Menu247_Click()
  
  Dim Myform2 As Etiqcasier
  
  MyForm2 = New Etiqcasier("")
  MyForm2.Showmodal()
  
End

Public Sub Menu248_Click()
  
  Commerciaux.Show()
  
End

Public Sub Menu249_Click()
  
  StatComm.Show()
  
End

Public Sub Menu250_Click()
  
  StatComArt.Show()
  
End

Public Sub Menu251_Click()
  
  hForm = New Gsm("")
  hForm.Showmodal()
  
End

Public Sub Menu253_Click()
  
  Sms.Show()
  
End

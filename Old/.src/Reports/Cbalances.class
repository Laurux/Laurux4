' Gambas class file

Inherits PdfWriter
R As Integer
G As Integer
B As Integer

Public Sub _new()
  
  R = Start.R
  G = Start.G
  B = Start.B
  
End

Public Sub _free()
  
End

Public Sub Entete(sEntete As String)
  
  Me.AddPage
  Me.SetXY(2, 5)
  Me.SetFont("Helvetica", "B", 16)
  Me.SetFillColor(R, G, B)
  Me.cell(206, 8, sEntete, True, 0, "C", True)
  
End

'Page footer
Public Function BasPage()
  
  Me.SetY(-10)
  Me.SetFont("Helvetica", "I", 8)
  Me.SetFillColor(R, G, B)
  Me.Cell(190, 6, "Page " & Me.PageNo() & "/{nb}" & " - " & Format$(Date(Now), "dd/mm/yyyy") & " - Impression demandée par " & User.Name, False, 0, "C", False)
  
End

Public Sub Level0(nom As String, dateedition As String, ste As String)
  
  Me.SetXY(2, 15)
  Me.SetFont("Helvetica", "B", 9)
  Me.cell(190, 8, ste & ".  " & nom & " " & dateedition, False, 0, "C", False)
  
End

'Entete avec cumul hors période
Public Sub Level1()
  
  Dim h As Integer = 10
  
  Me.SetXY(2, 24)
  Me.SetFont("Helvetica", "", 9)
  Me.SetFillColor(R, G, B)
  Me.cell(20, h, "Compte", True, 0, "C", True)
  Me.cell(42, h, "Intitulé", True, 0, "C", True)
  h = 5
  Me.cell(40, h, "Cumul période", True, 0, "C", True)
  Me.cell(40, h, "Cumul hors période", True, 0, "C", True)
  Me.cell(40, h, "Total", True, 0, "C", True)
  h = 10
  Me.cell(20, h, "Solde", True, 0, "C", True)
  Me.SetXY(64, 29)
  h = 5
  Me.cell(20, h, "Débit", True, 0, "C", True)
  Me.cell(20, h, "Crédit", True, 0, "C", True)
  Me.cell(20, h, "Débit", True, 0, "C", True)
  Me.cell(20, h, "Crédit", True, 0, "C", True)
  Me.cell(20, h, "Débit", True, 0, "C", True)
  Me.cell(20, h, "Crédit", True, 0, "C", True)
  
End

'Ligne détail avec cumul hors période
Public Sub Level2(code As String, intitule As String, stotdeb As String, stotcred As String, sdebhp As String, scredhp As String, totdeb2 As String, totcred2 As String, totsld2 As String, PosY As Integer)
  
  Dim h As Integer = 3
  
  Me.SetXY(2, posY)
  Me.SetFont("Helvetica",, 7)
  Me.cell(20, h, Code, False, 0, "L", False)
  Me.cell(42, h, Intitule, False, 0, "L", False)
  Me.cell(20, h, stotdeb, False, 0, "R", False)
  Me.cell(20, h, stotcred, False, 0, "R", False)
  Me.cell(20, h, sdebhp, False, 0, "R", False)
  Me.cell(20, h, scredhp, False, 0, "R", False)
  Me.cell(20, h, totdeb2, False, 0, "R", False)
  Me.cell(20, h, totcred2, False, 0, "R", False)
  Me.cell(20, h, totsld2, False, 0, "R", False)
  
End

'Total classe
Public Sub Level3(clas As String, debclass As String, credclass As String, debclasshp As String, credclasshp As String, sldclassdeb As String, sldclasscred As String, sldclass As String, PosY As Integer)
  
  Dim h As Integer = 5
  
  Me.SetXY(26, posY)
  Me.SetFont("Helvetica",, 7)
  Me.SetXY(26, posY)
  Me.SetFont("Helvetica", "B", 8)
  Me.cell(42, h, "Total classe " & clas, False, 0, "L", False)
  Me.cell(20, h, debclass, True, 0, "R", True)
  Me.cell(20, h, credclass, True, 0, "R", True)
  Me.cell(20, h, debclasshp, True, 0, "R", True)
  Me.cell(20, h, credclasshp, True, 0, "R", True)
  Me.cell(20, h, sldclassdeb, True, 0, "R", True)
  Me.cell(20, h, sldclasscred, True, 0, "R", True)
  Me.cell(20, h, sldclass, True, 0, "R", True)
  Me.Line(2, PosY + 5, 206, PosY + 5)
  
End

' Total balance
Public Sub Level4(totbaldeb As String, totbalcred As String, totbaldebhp As String, totbalcredhp As String, sldbaldeb As String, sldbalcred As String, sldbal As String, PosY As Integer)
  
  Dim sld As String
  Dim h As Integer = 5
  
  Me.SetXY(26, posY)
  Me.SetFont("Helvetica", "B", 8)
  Me.cell(42, h, "Total balance ", False, 0, "L", False)
  Me.cell(20, h, totbaldeb, True, 0, "R", True)
  Me.cell(20, h, totbalcred, True, 0, "R", True)
  Me.cell(20, h, totbaldebhp, True, 0, "R", True)
  Me.cell(20, h, totbalcredhp, True, 0, "R", True)
  Me.cell(20, h, sldbaldeb, True, 0, "R", True)
  Me.cell(20, h, sldbalcred, True, 0, "R", True)
  Me.cell(20, h, sldbal, True, 0, "R", True)
  
End

'Entete sans cumul hors période
Public Sub Level1a()
  
  Dim h As Integer = 10
  
  Me.SetXY(26, 24)
  Me.SetFont("Helvetica", "", 9)
  Me.SetFillColor(R, G, B)
  Me.cell(20, h, "Compte", True, 0, "C", True)
  Me.cell(62, h, "Intitulé", True, 0, "C", True)
  h = 5
  Me.cell(40, h, "Cumul période", True, 0, "C", True)
  h = 10
  Me.cell(20, h, "Solde", True, 0, "C", True)
  h = 5
  Me.SetXY(108, 29)
  Me.cell(20, h, "Débit", True, 0, "C", True)
  Me.cell(20, h, "Crédit", True, 0, "C", True)
  
End

'Lignes de detail sans cumul hors période
Public Sub Level2a(code As String, intitule As String, stotdeb As String, stotcred As String, posY As Integer)
  
  Dim sld As String
  Dim h As Integer = 3
  
  If IsNull(Stotdeb) Then Stotdeb = "0"
  If IsNull(Stotcred) Then Stotcred = "0"
  sld = Format$(Val(Utils.cpoint(Stotdeb)) - Val(Utils.cpoint(Stotcred)), ",0.00")
  If Stotdeb = "0" Then stotdeb = ""
  If stotcred = "0" Then stotcred = ""
  Me.SetXY(26, posY)
  Me.SetFont("Helvetica",, 8)
  Me.cell(20, h, Code, False, 0, "L", False)
  Me.cell(62, h, Intitule, False, 0, "L", False)
  Me.cell(20, h, stotdeb, False, 0, "R", False)
  Me.cell(20, h, stotcred, False, 0, "R", False)
  Me.cell(20, h, sld, False, 0, "R", False)
  
End

'Lignes du total des sous-comptes sans cumul hors période
Public Sub Level2s(code As String, intitule As String, stotdeb As String, stotcred As String, posY As Integer)
  
  Dim sld As String
  Dim h As Integer = 5
  
  Me.SetFillColor(240, 240, 240)
  If IsNull(Stotdeb) Then Stotdeb = "0"
  If IsNull(Stotcred) Then Stotcred = "0"
  sld = Format$(Val(Utils.cpoint(Stotdeb)) - Val(Utils.cpoint(Stotcred)), ",0.00")
  If Stotdeb = "0" Then stotdeb = ""
  If stotcred = "0" Then stotcred = ""
  'Me.Line(26, PosY, 170, PosY)
  Me.SetXY(26, posY)
  Me.SetFont("Helvetica", "", 8)
  Me.cell(142, h, "", True, 0, "L", True)
  Me.SetXY(26, posY)
  Me.cell(82, h, Intitule, False, 0, "L", False)
  Me.cell(20, h, stotdeb, False, 0, "R", False)
  Me.cell(20, h, stotcred, False, 0, "R", False)
  Me.cell(20, h, sld, False, 0, "R", False)
  Me.Line(26, PosY + 5, 128, PosY + 5)
  Me.SetFillColor(255, 255, 255)
  
End

Public Sub Level2sbis(cpt As String, posy As Integer)
  
  Me.SetXY(26, posY)
  Me.cell(142, 4, "Début des sous_comptes " & cpt & " " & String$(88, "*"), False, 0, "L", True)
  
End

'Total classe
Public Sub Level3a(clas As String, debclass As String, credclass As String, PosY As Integer)
  
  Dim sld As String
  Dim h As Integer = 5
  
  If IsNull(debclass) Then debclass = "0"
  If IsNull(credclass) Then credclass = "0"
  sld = Format$(Val(Utils.cpoint(debclass)) - Val(Utils.cpoint(credclass)), ",0.00")
  If debclass = "0" Then debclass = ""
  If credclass = "0" Then credclass = ""
  Me.SetXY(26, posY)
  Me.SetFont("Helvetica", "B", 8)
  Me.cell(82, h, "Total classe " & clas, False, 0, "L", False)
  Me.cell(20, h, debclass, True, 0, "R", True)
  Me.cell(20, h, credclass, True, 0, "R", True)
  Me.cell(20, h, sld, True, 0, "R", True)
  Me.Line(2, PosY + 5, 206, PosY + 5)
  
End

Public Sub Level4a(totbaldeb As String, totbalcred As String, PosY As Integer)
  
  Dim sld As String
  Dim h As Integer = 5
  
  If IsNull(totbaldeb) Then totbaldeb = "0"
  If IsNull(totbalcred) Then totbalcred = "0"
  sld = Format$(Val(Utils.cpoint(totbaldeb)) - Val(Utils.cpoint(totbalcred)), ",0.00")
  If totbaldeb = "0" Then totbaldeb = ""
  If totbalcred = "0" Then totbalcred = ""
  Me.SetXY(26, posY)
  Me.SetFont("Helvetica", "B", 8)
  Me.cell(82, h, "Total balance ", False, 0, "L", False)
  Me.cell(20, h, totbaldeb, True, 0, "R", True)
  Me.cell(20, h, totbalcred, True, 0, "R", True)
  Me.cell(20, h, sld, True, 0, "R", True)
  
End

'****************************************** Impression de la TVA ********************************************
'Entete société
Public Sub Level0T(dateedition As String, ste As String)
  
  Me.SetXY(2, 12)
  Me.SetFont("Helvetica", "B", 9)
  Me.cell(190, 8, ste, False, 0, "L", False)
  Me.SetXY(2, 16)
  Me.cell(190, 8, dateedition, False, 0, "L", False)
  
End

'Entete
Public Sub Level1T()
  
  Dim h As Integer = 5
  
  Me.SetXY(2, 24)
  Me.SetFont("Helvetica", "", 9)
  Me.SetFillColor(R, G, B)
  Me.cell(20, h, "Compte", True, 0, "C", True)
  Me.cell(62, h, "Intitulé", True, 0, "C", True)
  Me.cell(10, h, "Jal", True, 0, "C", True)
  Me.cell(14, h, "Date", True, 0, "C", True)
  Me.cell(20, h, "Numéro", True, 0, "C", True)
  Me.cell(19, h, "Lot", True, 0, "C", True)
  Me.cell(20, h, "Débit", True, 0, "C", True)
  Me.cell(20, h, "Crédit", True, 0, "C", True)
  Me.cell(21, h, "Solde", True, 0, "C", True)
  
End

'Lignes de detail
Public Sub Level2T(intitule As String, jour As String, dte As String, numero As String, Lot As String, montantd As String, montantc As String, solde As String, Posy As Integer)
  
  Dim h As Integer = 5
  
  If IsNull(montantd) Then montantd = "0"
  If IsNull(montantc) Then montantc = "0"
  If montantd = "0" Then montantd = ""
  If montantc = "0" Then montantc = ""
  Me.SetXY(22, posY)
  Me.SetFont("Helvetica",, 8)
  Me.cell(62, h, Intitule, False, 0, "L", False)
  Me.cell(10, h, jour, False, 0, "C", False)
  Me.cell(14, h, dte, False, 0, "C", False)
  Me.cell(20, h, numero, False, 0, "L", False)
  Me.cell(19, h, lot, False, 0, "L", False)
  Me.cell(20, h, montantd, False, 0, "R", False)
  Me.cell(20, h, montantc, False, 0, "R", False)
  Me.cell(20, h, solde, False, 0, "R", False)
  
End

'Lignes comptes
Public Sub Level3T(cpt As String, intit As String, Posy As Integer)
  
  Dim h As Integer = 5
  
  Me.SetXY(2, posY)
  Me.SetFont("Helvetica", "B", 9)
  Me.cell(20, h, cpt, False, 0, "L", False)
  Me.cell(100, h, intit, False, 0, "L", False)
  
End

'total compte
Public Sub Level4T(totd As String, totc As String, tots As String, Posy As Integer)
  
  Dim h As Integer = 5
  
  Me.SetXY(108, posY)
  Me.SetFont("Helvetica", "BI", 8)
  Me.cell(100, h, "Total compte", False, 0, "L", False)
  Me.SetXY(148, posY)
  Me.cell(20, h, Format$(totd, ",0.00"), False, 0, "R", False)
  Me.cell(20, h, Format$(totc, ",0.00"), False, 0, "R", False)
  Me.cell(20, h, Format$(tots, ",0.00") & " ", False, 0, "R", False)
  
End

'total Tva
Public Sub Level4TVA(totd As String, totc As String, tots As String, Posy As Integer, Type As String)
  
  Dim h As Integer = 5
  
  Me.SetXY(108, posY)
  Me.SetFont("Helvetica", "BI", 8)
  If type = "1" Then
    Me.cell(100, h, "Total TVA achats", True, 0, "L", True)
  Else
    Me.cell(100, h, "Total TVA ventes", True, 0, "L", True)
  Endif
  Me.SetXY(148, posY)
  Me.cell(20, h, Format$(totd, ",0.00"), False, 0, "R", False)
  Me.cell(20, h, Format$(totc, ",0.00"), False, 0, "R", False)
  Me.cell(20, h, Format$(tots, ",0.00") & " ", False, 0, "R", False)
  
End

'total edition
Public Sub Level5T(totd As String, totc As String, tots As String, Dte As String, Posy As Integer)
  
  Dim h As Integer = 5
  
  'Me.SetXY(108, posY)
  'Me.SetFont("Helvetica", "BI", 8)
  'Me.cell(100, h, "Total extrait", True, 0, "L", True)
  'Me.SetXY(148, posY)
  'Me.cell(20, h, Format$(totd, "0.00"), False, 0, "R", False)
  'Me.cell(20, h, Format$(totc, "0.00"), False, 0, "R", False)
  'Me.cell(20, h, Format$(tots, "0.00") & " ", False, 0, "R", False)
  Me.SetFont("Helvetica", "BI", 10)
  Me.SetXY(80, posY)
  If Val(Format$(tots, "0.0")) <= 0 Then
    Me.cell(100, h, Dte & " -->", False, 0, "C", False)
  Else
    Me.cell(100, h, Dte & " -->", False, 0, "C", False)
  Endif
  Me.SetXY(188, posY)
  Me.cell(20, h, Format$(tots, ",0.00") & " ", False, 0, "R", False)
  
End

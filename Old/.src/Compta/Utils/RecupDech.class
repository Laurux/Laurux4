' Gambas class file

Static hfil As File

Static Public Sub run()
  
  Dim rResult As Result
  
  HFil = Open User.Home & "/Dtech.txt" For Write Create
  rResult = Utils.db.Exec("SELECT * FROM " & Cbase.Table("TabMvt") & " where  left(compte,3) = &1 and collectif is null and dateech is not null or left(compte,3) = &2 and collectif is null and dateech is not null order by numero", "401", "411")  
  If rResult.Available Then
    Print rResult.count
    Repeat
      Print #HFil, rResult!numdoc & ";" & rResult!compte & ";" & rResult!dateech & ";"
    Until rResult.MoveNext()
  Endif
  Close #HFil
  Message.Info("Traitement termin√© !")
  
End

Public Sub Button2_Click()
  
  Me.close
  
End

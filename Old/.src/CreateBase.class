' Gambas class file

Public Sub createbase(type As String, login As String, Password As String, host As String, Port As String)
  
  Dim hcon As New Connection
  
  Music.Load(Start.Musique)
  If Start.son Then
    Music.Play
  Endif
  If message.Question(" Attention ! Aucune base n'a été trouvée !\nUne nouvelle base va être créée !", " Oui ", " Non ") = 1 Then
    Me.mouse = Mouse.wait
    Try Utils.db.Close
    
    hcon.type = hcon
    hcon.Name = "Laurux01"
    hcon.Login = Login
    hcon.Password = Password
    hcon.Host = Host
    hcon.Port = Port
    hcon.open
    Utils.db.Databases.Add("Laurux01")
    hcon.Close
    hcon.Open
    hcon.exec("SET NAMES 'latin1'")
    Me.mouse = Mouse.Default
    Message.Warning("La base a été créée ! Veuillez restaurez la base Laurux01.sql située sous le répertoire ~/Laurux3")
    Settings["/dbase/type"] = "mysql"
    Settings["/dbase/Name"] = "Laurux01"
    Settings["/dbase/Login"] = login
    Settings["/dbase/Password"] = hexdblKey.crypt("en", Password, "Laurux")
    Settings["/dbase/Port"] = Port
    Settings["/dbase/Host"] = Host
    Settings["/dbase/Maj"] = "0"
  Endif
  
End

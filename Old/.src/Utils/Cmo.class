' Gambas class file

' Gambas CLASS file
'----------------------------------------------------------------------------
'

'
'Ce programme est un logiciel libre; Vous pouvez le redistribuer et/ou
'le modifier selon les termes de la GNU General PUBLIC License publiés par
'la Free Software Foundation.

'Ce programme est distribué sans garantie. Voyez la GNU General PUBLIC
'License pour plus de details.

'Vous devez lire la GNU General PUBLIC Licence.
'Si vous ne disposez pas d'un exemplaire, veuillez écrire
'à " The Free Software Foundation
'INC, 59 Temple place - Suite 33, Boston
'MA 02111-1307 USA
'----------------------------------------------------------------------------
'################################################
'# nom du fichier           : Cmo.class
'# Auteur                   : Jacky Tripoteau
'# date de création         : 30/11/2007
'# Gestion des couleurs des mo
'################################################


sColor As String
Value As String
Motemps As String
Momontant As String
B As Integer

'*********************************
'*    initialisation écran       *
'*********************************
Public Sub _New()
Me.Center
Motemps = Settings["/Coul/Motps"]
If IsNull(Motemps) Then Motemps = "&HF9F9BD&"
Motps2.Text = Motemps
Motps.Background = Val(Motemps)

Momontant = Settings["/Coul/Momnt"]
If IsNull(Momontant) Then Momontant = "&HF9F9BD&"
Momnt2.Text = Momontant
Momnt.Background = Val(Momontant)

End

Public Sub Coul_Dblclick()
Pcol.Show
Select Case Last.tag
  Case 1
    dlgColor.SelectedColor = Val(Motemps)
    b = 1
    Stop Event
  Case 2
    dlgColor.SelectedColor = Val(Momontant)
    b = 2
    Stop Event
End Select
End

Public Sub btnOK_Click()
  sColor = dlgColor.SelectedColor
  Value = "&H" & Hex$(dlgColor.SelectedColor, 6) & "&"
  Pcol.Hide
  Select Case B
  Case 1
    Motps2.Text = Value
    Motps.Background = dlgColor.SelectedColor
  Case 2
    Momnt2.Text = Value
    Momnt.Background = dlgColor.SelectedColor
  End Select
End

Public Sub btnRetour_Click()

  Pcol.Hide

End

Public Sub Btn_Click()
Select Case Last.tag
  Case 1
Settings["/Coul/Motps"] = Motps2.Text
Settings["/Coul/Momnt"] = Momnt2.Text

  Me.close
  Case 2
  Me.Close
End Select
End
